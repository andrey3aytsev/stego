function fraction_2_bin(e){var t=Math.round(255*e);return t=add_zeros(t.toString(2),8)}function add_zeros(e,t){return e=e.toString(),e.length<t?add_zeros("0"+e,t):e}function download_canvas(){var e=canvas.toDataURL();this.href=e}var canvas=document.getElementById("canvas-pixels"),ctx=canvas.getContext("2d");document.getElementById("btn-download").addEventListener("click",download_canvas,!1);var text_bin="101010100101010101010101010010101010101",text_index=0,source_img=document.getElementById("mona"),source_img_width=source_img.clientWidth,source_img_height=source_img.clientHeight,pix_wid=1/source_img_width*100,raster=new Raster("mona"),colors_cont=$("#bin"),pix_block=$("#pix_block"),pixels_colors=[];raster.on("load",function(){raster.size=new Size(source_img_width,source_img_height);for(var e=0;e<raster.height;e++)for(var t=0;t<raster.width;t++){var n=raster.getPixel(t,e),i=fraction_2_bin(n.red),r=fraction_2_bin(n.green),o=fraction_2_bin(n.blue),a=i,_=r,s=o;pixels_colors.push([i,r,o]),text_index<=text_bin.length&&(a=i.substring(0,i.length-1)+text_bin[text_index],n.red=a),text_index+1<=text_bin.length&&(_=r.substring(0,r.length-1)+text_bin[text_index+1],n.green=_),text_index+2<=text_bin.length&&(s=o.substring(0,o.length-1)+text_bin[text_index+2],n.blue=s),text_index+=3,pix_block.append('<span style="width: '+pix_wid+"%; padding-bottom: "+pix_wid+"%; background: rgb("+parseInt(a,2)+","+parseInt(_,2)+","+parseInt(s,2)+')"></span>');var d=new Rectangle({center:new Point(t,e),radius:[1,1]});d.fillColor=n}project.activeLayer.position=view.center}),project.activeLayer.position=view.center;